@if (authService.isAuthenticated()) {
  <div class="app-shell">
    <aside class="sidebar" [class.show]="sidebarOpen()" [class.collapsed]="sidebarCollapsed()" aria-label="Side navigation">
    <div class="brand">
      <span>Task Manager</span>
      <button class="collapse-btn" (click)="toggleCollapse()" title="Collapse">⟷</button>
    </div>
    
    <app-family-selector></app-family-selector>
      
      <div class="user-info">
        <div class="user-avatar">{{ authService.currentUser()?.name?.charAt(0) || 'U' }}</div>
        <div class="user-details">
          <div class="user-name">{{ authService.currentUser()?.name }}</div>
          <div class="user-email">{{ authService.currentUser()?.email }}</div>
        </div>
      </div>
      
      <nav class="menu">
        <a routerLink="/tasks" routerLinkActive="active" (click)="closeSidebar()">
          <span class="icon">✅</span>
          <span class="label">Tasks</span>
        </a>
        <a routerLink="/appointments" routerLinkActive="active" (click)="closeSidebar()">
          <span class="icon">📅</span>
          <span class="label">Appointments</span>
        </a>
        <a routerLink="/contacts" routerLinkActive="active" (click)="closeSidebar()">
          <span class="icon">📇</span>
          <span class="label">Contacts</span>
        </a>
        <a routerLink="/doctors" routerLinkActive="active" (click)="closeSidebar()">
          <span class="icon">🩺</span>
          <span class="label">Doctors</span>
        </a>
        <a routerLink="/family" routerLinkActive="active" (click)="closeSidebar()">
          <span class="icon">👪</span>
          <span class="label">Family</span>
        </a>
        <a routerLink="/family-member" routerLinkActive="active" (click)="closeSidebar()">
          <span class="icon">👤</span>
          <span class="label">Family Member</span>
        </a>
        <a routerLink="/documents" routerLinkActive="active" (click)="closeSidebar()">
          <span class="icon">📁</span>
          <span class="label">Documents</span>
        </a>
      </nav>
      
      <div class="logout-section">
        <button class="logout-btn" (click)="logout()">
          <span class="icon">🚪</span>
          <span class="label">Logout</span>
        </button>
      </div>
    </aside>
    <main class="content" [class.expanded]="sidebarCollapsed()">
      <header class="topbar">
        <button class="menu-btn" aria-label="Open menu" (click)="toggleSidebar()">
          <span></span><span></span><span></span>
        </button>
        <h1>{{ title() }}</h1>
      </header>
      <section class="page">
        <router-outlet />
      </section>
    </main>
    </div>
  @if (sidebarOpen()) {
    <div class="backdrop" (click)="closeSidebar()"></div>
  }
} @else {
  <div class="signin-container">
    <router-outlet />
  </div>
}
